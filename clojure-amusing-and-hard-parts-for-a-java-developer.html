<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
  <meta charset="utf-8">
  <!-- Site Meta Data -->
  <title>Clojure - Amusing and Hard parts for a Java developer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Kannan Ramamoorthy">

  <link rel="shortcut icon" href="">

  <!-- schema.org -->
  <meta itemprop="name" content="My Thought Buddy">
  <meta itemprop="image" content="">
  <meta itemprop="description" content="">

  <!-- Style Meta Data -->
  <link rel="stylesheet" href="./theme/css/milligram.css" type="text/css" />
  <link rel="stylesheet" href="./theme/css/custom.css" type="text/css" />

  <!-- Feed Meta Data -->

  <!-- Twitter Feed -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="">
  <meta name="twitter:image" content="">

<meta name="twitter:creator" content="">
<meta name="twitter:url" content="./clojure-amusing-and-hard-parts-for-a-java-developer.html">
<meta name="twitter:title" content="My Thought Buddy ~ Clojure - Amusing and Hard parts for a Java developer">
<meta name="twitter:description" content="Intro: I’ve been experimenting with Clojure for recent months. As I was learning, there were moments of amusement and difficulties. This is intended to share those moments to any fellow Java developers. This is not a Clojure tutorial. The ‘Amusing parts’ is intended to give you a glimpse of …">

<!-- Facebook Meta Data -->
<meta property="og:title" content="My Thought Buddy ~ Clojure - Amusing and Hard parts for a Java developer" />
<meta property="og:description" content="Intro: I’ve been experimenting with Clojure for recent months. As I was learning, there were moments of amusement and difficulties. This is intended to share those moments to any fellow Java developers. This is not a Clojure tutorial. The ‘Amusing parts’ is intended to give you a glimpse of …" />
<meta property="og:image" content="" />
</head>

<body>
    <div class="container">

    <!-- Navbar -->
      <div class="navbar">
        <ul>
            <div>
                <li>
                    <a href="."><h2>My Thought Buddy</h2></a>
                </li>
                <li>
                        <em><h5>(->> thoughts 
 (filter #(curious? %)) 
 (post-here))</h5></em>
                </li>
            </div>
        </ul>
      </div>

  <!-- Sidebar -->
    <sidebar>
       <!-- Content showing social links -->
        <p> 
                <span>
                    <a href="https://github.com/kannangce" target="_blank">
                        <img class="social-icons-m" src="./theme/images/icons/github.png">
                    </a>
                </span>
                <span>
                    <a href="https://stackexchange.com/users/2333642/kannan?tab=accounts" target="_blank">
                        <img class="social-icons-m" src="./theme/images/icons/so.png">
                    </a>
                </span>
                <span>
                    <a href="https://www.linkedin.com/in/kannan-ramamoorthy-54793145/" target="_blank">
                        <img class="social-icons-m" src="./theme/images/icons/linked-in.png">
                    </a>
                </span>
                <span>
                    <a href="https://twitter.com/kannangce" target="_blank">
                        <img class="social-icons-m" src="./theme/images/icons/twitter.png">
                    </a>
                </span>
        </p>
       <!-- Content showing social links -->

        <p>
        </p>
        <p>
        </p>

        <ul class="static-item">

        </ul>        

        <ul>
                <div class="cat-border">
                <li style="color: #F2F1EF; background-color: #6C7A89;">Categories</li>
                    <li><a href="./category/clojure.html">Clojure</a></li>
                    <li><a href="./category/command-line.html">Command-Line</a></li>
                    <li><a href="./category/computer-science-algorithm.html">Computer Science, Algorithm</a></li>
                    <li><a href="./category/diy.html">DIY</a></li>
                    <li><a href="./category/docker.html">Docker</a></li>
                    <li><a href="./category/documentation.html">Documentation</a></li>
                    <li><a href="./category/introspection.html">Introspection</a></li>
                    <li><a href="./category/java.html">Java</a></li>
                    <li><a href="./category/java-java-debugging.html">Java, Java Debugging</a></li>
                    <li><a href="./category/java-spring.html">Java Spring</a></li>
                    <li><a href="./category/mathematics.html">Mathematics</a></li>
                    <li><a href="./category/misc-thoughts.html">Misc Thoughts</a></li>
                    <li><a href="./category/personal.html">Personal</a></li>
                    <li><a href="./category/practice.html">Practice</a></li>
                    <li><a href="./category/productivity.html">Productivity</a></li>
                    <li><a href="./category/qa.html">QA</a></li>
                    <li><a href="./category/software.html">Software</a></li>
                    <li><a href="./category/software-design.html">Software Design</a></li>
                </div>
        </ul>

   
    </sidebar>
    
    <maincontent>
<h2>
    <a href="./clojure-amusing-and-hard-parts-for-a-java-developer.html" rel="bookmark" title="Permalink to Clojure - Amusing and Hard parts for a Java developer">Clojure - Amusing and Hard parts for a Java developer</a>
</h2>

<div>
    <b>By: </b><a href="./author/kannan-ramamoorthy.html">Kannan Ramamoorthy</a><b>    On: </b>Sat 10 August 2019<br />
    <b>In: </b><a href="./category/clojure.html" rel="bookmark" title="Permalink to Clojure">Clojure</a><br />
    <em><b>Tags: </b>
                <span><a href="./tag/clojure.html">#Clojure </a></span>
                <span><a href="./tag/fp.html">#FP </a></span>
                <span><a href="./tag/programming.html">#Programming </a></span>
    </em>
    <hr>
</div>

<div>
    <mainarticle>
    <div class="sect1">
<h2 id="_intro">Intro:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I’ve been experimenting with Clojure for recent months. As I was learning, there were moments of amusement
 and difficulties. This is intended to share those moments to any fellow Java developers.</p>
</div>
<div class="paragraph">
<p><strong>This is not a Clojure tutorial.</strong></p>
</div>
<div class="paragraph">
<p>The <em>‘Amusing parts’</em> is intended to give you a glimpse of what Clojure can do even if you don’t have prior
experience in Clojure.</p>
</div>
<div class="paragraph">
<p>The <em>‘Hard parts’</em> is intended to give a heads-up if you are starting with Clojure. Since the reader is
 assumed to be new to Clojure, this section might help the user know what it takes to get comfortable with
 Clojure and not to give up soon.</p>
</div>
<div class="paragraph">
<p><em>Please do let me know if the above-mentioned sections don&#8217;t meet what it claims.</em></p>
</div>
<div class="paragraph">
<p>To quickly try out the snippets in this document you can use <a href="https://repl.it/languages/clojure">repl.it</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_disclaimer">Disclaimer:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Throughout this article, there would be lots of comparison between Clojure and Java.
The comparison is in no way to demean Java. Java is ubiquitous and IMHO it will continue to be so for a few
more decades.</p>
</div>
<div class="paragraph">
<p>I’m comparing with Java because it is the only language which I’m well versed with currently. I&#8217;m still
working in Java and think most of the solutions in Java.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clojure_primer">Clojure Primer:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get a feel of what I realized, the reader might need a quick intro to Clojure. I’ll try to get some
basics set here.</p>
</div>
<div class="paragraph">
<p>The <em>‘Clojure Primer’</em> part is meant just to give a quick mental model on Clojure. That section is
oversimplified and I might have used some non-standard terms to solve the purpose. Hence, this is not meant
as a reference in anyways.</p>
</div>
<div class="paragraph">
<p>To define, Clojure is a dynamically typed, functional programming language in Lisp dialect and runs on JVM.</p>
</div>
<div class="sect2">
<h3 id="_oversimplified_syntax">(Over)simplified Syntax:</h3>
<div class="paragraph">
<p>Any Clojure expressions that you write follows the syntax,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code> (operator &lt;argument1&gt; &lt;argument2&gt; ..)</code></pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Where &#8216;operator&#8217; is a term that I gave here for a ‘function/macro/special forms’, and not a standard term
used in the Clojure world. You will get to know about it shortly.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>For ex,</p>
</div>
<div class="paragraph">
<p>To add 3 numbers you would say</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(+ 1 2 3)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Meaning:</strong></p>
</div>
<div class="paragraph">
<p><code>+</code> is the <em>'operator'</em>,  1, 2 and 3 are parameters</p>
</div>
<div class="paragraph">
<p>To print the biggest of 2 numbers, you would say,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(if (&gt; 2 1) (print 2) (print 1))</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Meaning:</strong></p>
</div>
<div class="paragraph">
<p><code>if</code> is 'operator',  <code>(&gt; 2 1)</code>, <code>(print 2)</code> , <code>(print 1)</code> are its parameters. Where the first parameter is
the condition, the second parameter is the path when the condition succeeds, the third if it fails.</p>
</div>
<div class="paragraph">
<p>Again, within each of them, <code>&gt;</code>  and <code>print</code> are 'operators' along with their respective parameters.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>And that&#8217;s all about the syntax of the language. Rest of the things that you need to know is different
'operators' that you might need and how it work*</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_function">Function:</h3>
<div class="paragraph">
<p>A function is the same as a method in Java. It accepts 0 or more parameters does something and might return a result.</p>
</div>
</div>
<div class="sect2">
<h3 id="_macro">Macro:</h3>
<div class="paragraph">
<p>In programs, macros look the same as a function. 'But', instead of getting executed it accepts a parameter and returns a Clojure code to be executed.</p>
</div>
<div class="paragraph">
<p>This allows you to plugin a transformation logic, which transform the parameter of a Macro into some other code.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_amusing_parts">Amusing Parts:</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_simple_syntax">Simple Syntax:</h3>
<div class="paragraph">
<p>As mentioned in the primer, the syntax is so simple and standard.</p>
</div>
<div class="paragraph">
<p>Some examples,</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(<code>+</code> 1 2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Add' 1 and 2.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(<code>=</code> v1 v2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Equality check' for values of 'v1' and 'v2'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(<code>ns</code>  new-name-space)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Switches namespace' to “new-name-space”. (Namespace is equivalent to Java&#8217;s package)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(<code>println</code> “Test String”)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Prints' the given string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(<code>def</code> v 1)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Define' a variable ‘v’ with value 1 (in the current namespace)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(<code>defn</code> prn [x] (prinln x))</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Define' a function named 'prn' that accepts a parameter and prints it.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_less_special_constructs">Less Special Constructs:</h3>
<div class="paragraph">
<p>In a language “Special constructs“ can be defined as something that you are not sure how it is
happening until you dig deep. Usually, there will be a set of limited constructs on which
the whole language is built.</p>
</div>
<div class="paragraph">
<p>For example, take the below Java excerpt of a factorial implementation,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>// This logic is not perfect. But it is intended to prove the point.
public static int fact(int a)
{
	if ((a == 1) || (a == 0) )
	{
		return 1;
	}
	else
	{
		return a * fact(--a);
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It says if <code>a</code> is '1' or '0' then return 1 or multiply <code>a</code> with the <code>fact(a -1)</code>.</p>
</div>
<div class="paragraph">
<p>As a typical Java developer on the meanings (implementation/definition) of the constructs
like <code>public</code>, <code>static</code>, <code>int</code>,  <code>if .. else ..</code>, <code>||</code> , <code>return</code> , <code>*</code> , and <code>--</code> you have to take it as is
or dig deep into the JVM/JDK to know how it is implemented. You’re not sure how it is implemented
and you cannot implement something like that on your own.</p>
</div>
<div class="paragraph">
<p>In the case of Clojure, the equivalent of the above snippet can be,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(defn fact [a]
(if (or (= a 1) (= a 0))
 1
(* a
  (fact (dec a)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above snippet, except <code>if</code> everything else is a function/macro. Which means you can (re)define it yourself.
For now, don’t worry about what function/macro means. You will get to know about it shortly.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The special constructs in Clojure are so less and the rest of things are just build on top
of those special constructs. Which means most of the Clojure code can be seen or even
developed by yourself(if you wish).</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_infinitelazy_sequence_as_a_normal_sequence">Infinite/lazy sequence as a normal sequence:</h3>
<div class="paragraph">
<p>As a Java developer, we hardly heard about infinite sequence before Java 8 streams(eg, <code>Stream.iterate</code>).
Even after Java 8, we don&#8217;t use it often.  The primary reason is that the infinite/lazy sequence is offered by Streams. Where Streams and Collections are kept apart by hierarchy and are not interchangeable.</p>
</div>
<div class="paragraph">
<p>In the case of Clojure, the lazy/infinite sequence is so commonly used. Primarily because there is not much difference in the way 'lazy' and 'normal' sequence is handled.</p>
</div>
<div class="paragraph">
<p>For ex, look at the below expressions,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(print (take 2 (list 0 1 2 3 4)))
; prints (0 1)

(print (take 2 (range)))
; Prints (1 2)

(print (take 10 (range)))
; Prints (0 1 2 3 4 5 6 7 8 9)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is apparent that <code>take n</code> takes the first n elements in the given sequence.
2 main inferences in the above examples are,</p>
</div>
<div class="olist arabic">
<div class="title"><code>range</code> virtually returns an infinite sequence which you can take (lazily) as you need.</div>
<ol class="arabic">
<li>
<p>The normal list and lazy sequence are treated in the same way and can be used interchangeably
(in most cases).
Thus providing you an opportunity to do a lazy evaluation whenever you normally use a sequence.</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Lazy sequence (mostly) behaves the same way as a normal sequence.
So you can defer the evaluation whenever possible.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_program_as_data">Program as Data:</h3>
<div class="paragraph">
<p>Before getting into detail, I would like to introduce you 2 constructs,</p>
</div>
<div class="sect3">
<h4 id="_list">list:</h4>
<div class="paragraph">
<p>List as in any other languages is a sequential data structure.
As seen in the above examples, you can create a list like,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(list 1 2 3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In short form, you can also write it as,</p>
</div>
<div class="paragraph">
<p>‘(1 2 3)</p>
</div>
</div>
<div class="sect3">
<h4 id="_quote">quote:</h4>
<div class="paragraph">
<p>If you imagine 'Clojure evaluator' as something that evaluates the expression that you give.
You can ask it not to evaluate some expressions by quoting it.</p>
</div>
<div class="paragraph">
<p>For ex,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(quote (+ 1 2))
; Returns (+ 1 2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In short, you can also write it as,</p>
</div>
<div class="paragraph">
<p>‘(+ 1 2)</p>
</div>
<div class="paragraph">
<p>Does the above 2 rings a bell? No?</p>
</div>
<div class="paragraph">
<p>If you noted any of the above Clojure snippets, doesn’t it resemble the list definition
 without a quote? Yeah. All your Clojure program is just a nested-list (i.e., tree) that is
evaluated by the Clojure evaluator. If you want to have just a list datastore without being
evaluated then you just quote it.</p>
</div>
<div class="paragraph">
<p>Let it be!</p>
</div>
<div class="paragraph">
<p>Why should we care if the program is a list/not-a-list?</p>
</div>
<div class="paragraph">
<p>This property of a programming language is called <a href="https://en.wikipedia.org/wiki/Homoiconicity">homoiconicity</a>. One main advantage of this property is it lets do meta-programming such as macros, which we’ll see in a moment.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Your Clojure program is nothing but a nested Clojure list.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_macros">Macros:</h3>
<div class="paragraph">
<p>We had an intro about macro in the primer section.</p>
</div>
<div class="paragraph">
<p>To elaborate, a macro lets you create syntactic abstraction. i.e., you can write macros that take anything that doesn’t even look like Clojure but returns a Clojure code for evaluation.</p>
</div>
<div class="paragraph">
<p>Some of the common logical operators in other languages such as and, or are macros in Clojure.
Other cool examples are list-iteration <a href="https://clojuredocs.org/clojure.core/for">(<code>for</code>)</a>,
thread-first macro <a href="https://clojuredocs.org/clojure.core/-%3E">(<code>&#8594;</code>)</a>,
thread-last macro <a href="https://clojuredocs.org/clojure.core/-%3E%3E">(<code>&#8594;&gt;</code>)</a> and a lot more.</p>
</div>
<div class="paragraph">
<p>For example, while learning about macro, I tried implementing the
<a href="https://github.com/kannangce/brave-clojure/blob/master/src/brave_clojure/8-exec-2.clj#L1"><code>or</code></a>
(Java equivalent <code>||</code>) operator.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Macros let you have syntactic abstraction and do meta-programming.
In other words, Macro is a program that writes(returns) a program.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_memoization">Memoization:</h3>
<div class="paragraph">
<p>Think that you have a function and when you call it with some parameters, the function will
be evaluated and the result will be returned. And if you call the function with the same parameters,
it won’t do the evaluation but just returns the result that we had earlier.</p>
</div>
<div class="paragraph">
<p>What&#8217;s so special about it? We do this in Java most of the times, you maintain a cache that
stores the result of an evaluation. On consecutive calls, we just return it. Yeah, we do that.</p>
</div>
<div class="paragraph">
<p>But I was amused that we don’t have to deal with the caching ourself and memoization works
can be used with almost all the functions(if needed) in Clojure because of referential transparency,
a property of pure functions.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Lets you wrap your function so that the wrapper takes care of caching the results
for a given set of parameters, without you having to deal with caching.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_core_async">core.async:</h3>
<div class="paragraph">
<p><code>core.async</code> library provides CSP style programming that involves threads communicating to each other
using channels. This is not much different from using threads and blocking queues that we have in Java.</p>
</div>
<div class="paragraph">
<p>One thing that I found fascinating is <code>alts!</code> function, which lets you wait on multiple channels at
once and gets the result from whichever comes first.</p>
</div>
<div class="paragraph">
<p>For example, <a href="https://github.com/kannangce/Misc-Clojure/blob/master/fastest-search.clj">this</a> program searches a keyword in 2 search engines and prints from which we had the fastest result.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>core.async lets you write clean inter-communicating threads.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_core_logic">core.logic:</h3>
<div class="paragraph">
<p>Not many of us would have heard about Constraint Logic Programming(CLP) in mainstream programming.
We’ll see it what it is with an example using Clojure&#8217;s <code>core.logic</code>.</p>
</div>
<div class="paragraph">
<p>Remember Sudoku?</p>
</div>
<div class="paragraph">
<p>To reiterate, you will have a 9X9 grid, which itself is subdivided into 9 3X3 sub-grids.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You have to place numbers from 1 to 9 in each column, row and the sub-grid.</p>
</li>
<li>
<p>So that the numbers must be unique in each of the row, column, and sub-grid.</p>
</li>
<li>
<p>Incidentally, you have to place all the 9 numbers in each row, column, and sub-grid.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Solving Sudoku means, filling up all the numbers in the row/column/sub-grid,
also satisfying the above mentioned <em>"Constraints"</em>.</p>
</div>
<div class="paragraph">
<p>Think, if you can have a (generic)program that takes all constraints(of any such problems) and spits out
 the solution.  <code>core.logic</code> is one such module in Clojure that lets you do ‘Constraint Logic Programming’.</p>
</div>
<div class="paragraph">
<p>Below is an excerpt from a
<a href="https://github.com/kannangce/Misc-Clojure/blob/master/core_logic_test/src/logic_test/sudoku.clj">sudoku solver</a>
in Clojure using core.logic,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>   (run 1 [q]
 ;; Solve for the lvar q
     (== q vars) ;; q should unify with the sequence of the lvars
     (everyg #(fd/in % (fd/domain 1 2 3 4 5 6 7 8 9)) vars) ;; For every entry in vars the range must be in 1 to 9
     (init vars hints) ;; Creates the goals to match the vars with the known hints.
     (everyg fd/distinct rows) ;; Every entry in rows must be unique.
     (everyg fd/distinct cols) ;; Every entry in cols must be unique.
     (everyg fd/distinct sqs)) ;; Every entry in sqs must be unique.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Problems like “Time-table creation”, “n-queens” are some basic candidates for core.logic.
CLP is a whole new area to explore as a mainstream programmer. It is good that you can do it with
Clojure using <code>core.logic</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><code>core.logic</code> lets you do prologue style CLP.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_isomorphic_counterpart_clojurescript">Isomorphic counterpart - Clojurescript:</h3>
<div class="paragraph">
<p>Similar to Isomorphic Javascripts, which can run on both browser and server,
Clojure has an isomorphic counterpart, Clojurescript. Wherein you can write Clojure code that gets compiled to Javascript.</p>
</div>
<div class="paragraph">
<p>With a glimpse, its cool to know that the goodness of Clojure will be available to be
compiled as Javascript to be executed in the browser.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>With CLJS, you may run your code on the server as well as in the browser.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_core_match">core.match :</h3>
<div class="paragraph">
<p><code>core.match</code> library of Clojure lets you write a concise conditional statement, which you might need nested and complicated <code>if..else</code>.</p>
</div>
<div class="paragraph">
<p>For example, with <code>core.match</code> you can write like,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>  (match [x y z]
    [_ 1 2] 1
    [1 2 _ ] 2
    [_ _ 1] 3
    [_ _ 2] 4
    :else 5)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which you might write in Java as,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>if (y == 1 &amp;&amp; z ==2)
{
  reutrn 1;
}
else if(x == 1 &amp;&amp; y == 2)
{
  return 2;
}
else if( z == 1)
{
  return 3;
}
else if(z == 2)
{
  return 4;
}
else
{
  return 5;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Not just for simple variables.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>core.match</code> works for data structures like vector, map, etc.</p>
</li>
<li>
<p>There are other sophisticated features like wildcard match, additional functional application, etc.</p>
</li>
<li>
<p>Backed by <a href="https://www.cs.tufts.edu/~nr/cs257/archive/luc-maranget/jun08.pdf">this paper</a>, the matches are optimized.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><code>core.match</code> lets you write concise conditional statements with sophistications such as wildcard, function application, etc.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_conciseness">Conciseness:</h3>
<div class="paragraph">
<p>One thing that primarily amuses other programmers is conciseness of Clojure.
Just to give a feel of it, I’m adding some of the examples. Clojure has a lot of such constructs,
but I’m just mentioning a few here. If you’re interested also take a look into a
<a href="http://kannangce.in/source-of-clojures-conciseness-part-1.html">detailed analysis</a>
on conciseness of Clojure using a particular example.</p>
</div>
<div class="sect3">
<h4 id="_list_iteration">List iteration:</h4>
<div class="paragraph">
<p>List iterator is familiar for Python-dev, but surely it is something new for a Java developer.
It is a constructor that lets you parallelly iterate through multiple sequences and produce a
single result from it.</p>
</div>
<div class="paragraph">
<p>For example to do a cartesian product of 2 lists the below 1-liner would do,</p>
</div>
<div class="paragraph">
<p><code>(for [x '(1 2 3) y '(1 2 3)] [x y])</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_slurp">slurp:</h4>
<div class="paragraph">
<p><code>slurp</code> is a Clojure function to read files.
And the nice thing about this function is that you can use this to read a file from
local disc, HTTP(s), FTP.</p>
</div>
<div class="paragraph">
<p>For example, you can use slurp as below,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(slurp "/Users/me/sample.txt")
(slurp "https://google.com")
(slurp "ftp://localhost:2121/sample.txt")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_fibonacci_solution_that_you_can_tweet">A Fibonacci solution that you can tweet:</h4>
<div class="paragraph">
<p>The below snippet gives you the Fibonacci series up to any number that you want, just using built-in
functions/macros. To understand you need some hands-on. But this snippet sure won’t fail to amuse you.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(def fib
  (lazy-cat [0 1] (map + (rest fib) fib)))
(take 10 fib)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_java_interop">Java Interop:</h3>
<div class="paragraph">
<p>Along with all other goodness of Clojure, Clojure works well with Java. You can use the ocean of
libraries from Java in Clojure.</p>
</div>
<div class="paragraph">
<p>Example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(println (System/currentTimeMillis))
; prints Current time in milliseconds. Equivalent of calling System.currentTimeMillis()

(doto (new java.util.HashMap) (.put "one" 1) (.put "two" 2))
; Creates a new hashmap
; Calls put(“one”, 1) and put(“two”,2) on the map.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_further_amusements">Further amusements:</h3>
<div class="paragraph">
<p>There are lot more amusements that I didn’t include, as to realize the importance of those some basic
hands-on is needed. While starting, it is worth to have a look at Tail-recursion,
Software Transaction Management(STM), Transducers, multi-methods, protocols and a lot more.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hard_parts">Hard Parts:</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_usage_of_parentheses">Usage of parentheses:</h3>
<div class="paragraph">
<p>I’m fine with too many parentheses. But initially, I was not clear about the usage of parentheses.
Like in Java, you cannot use an arbitrary number of parentheses. Everything that you put into parentheses
is evaluated assuming the first element within parentheses is an <code>operator</code>.</p>
</div>
<div class="paragraph">
<p>Hence (+ 1 2 3) works whereas, (+ 1 (2 3)) won’t work.
Because after <code>(</code> there must be an <code>operator</code>, where 2 is not one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_shift_to_s_expression">Shift to s-expression:</h3>
<div class="paragraph">
<p>With <a href="https://en.wikipedia.org/wiki/S-expression">S-expression</a> (the expression syntax of Clojure and other
Lisp), we need a switch from Java style of expression, especially the logical/arithmetic expressions.</p>
</div>
<div class="paragraph">
<p>For example, <code>1 + 2 + 3</code> will be written as <code>(+ 1 2 3)</code>.
But it was a bit hard to convert logical operations such as <code>(2 &gt; 1)</code> in Java to <code>(&gt; 2 1)</code> in Clojure.
Because the operator&#8217;s nose is pointing to <code>2</code> gives an impression that check means if 2 is smaller.</p>
</div>
<div class="paragraph">
<p>But it got easy after reading the documentation of <code>&gt;</code>, which says it will check if the given numbers are
in ‘decreasing order’. i.e., you can also check if <code>(&gt; 2 1 0)</code> is <code>true</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_immutable_datastructures">Immutable Datastructures:</h3>
<div class="paragraph">
<p>Almost all the Clojure&#8217;s core data-structures are immutable.
For example, when you add, remove an element in a list, the operation will result in a new list
but won’t change the source list. This was a deliberate decision to keep concurrency in place.</p>
</div>
<div class="paragraph">
<p>In Java, having used to adding/removal/changing the Collections element so commonly,
this was initially <strong>'very'</strong> difficult. Had to practice a lot to get over.
In Clojure, we typically use recursion for most of the problems that typically require modification
in the data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dynamic_programming">Dynamic programming:</h3>
<div class="paragraph">
<p>With dynamic programming, you divide your problem into much smaller problems and use the solutions
of the already solved ones, to make the problem solving faster.</p>
</div>
<div class="paragraph">
<p>One problem that I stuck for a long time was <a href="https://projecteuler.net/problem=15">Level-15</a> of Project Euler.
I tried an initial solution which worked well for small numbers, but even for number asked in the question
(which is not so large), my program didn’t finish even after a whole day.
Because this required dynamic-programming approach and Clojure doesn’t support mutability for basic
data structures.</p>
</div>
<div class="paragraph">
<p>It took nearly 2-weeks for me to know and try <code>memoization</code> and came with a
<a href="https://github.com/kannangce/project-euler/blob/master/src/project_euler/15-no-of-paths-optimized-1.clj">solution</a>
using the dynamic programming approach which took only a few seconds to solve the problem.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lazy_sequence">Lazy sequence:</h3>
<div class="paragraph">
<p>The lazy sequence was both amusing and hard to imagine. When I tried, it took a couple of hours to
understand before I come up with a
<a href="https://github.com/kannangce/Misc-Clojure/blob/master/van-eck-generator.clj">solution</a> on my own for
'van-eck generator' with a lazy sequence.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_faqs">FAQs:</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Q:</strong> You say core data structures are not mutable. So how a very basic use case of addition or deletion of
the element from a data structure is addressed?</p>
</div>
<div class="paragraph">
<p>Clojure does support those operations. But it doesn’t change the original data structure.
For ex,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(def a [1 2]) ; Define a vector with 1,2

(println (conj a 3)) ; Append 3 to it
;; Prints [1 2 3]

(println a)
;; Prints [1 2]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Q:</strong> What?! Do you create a new collection for each change that we do? Aren’t you filling up the
memory unnecessarily?</p>
</div>
<div class="paragraph">
<p>Nope. Clojure uses a mechanism called <a href="https://en.wikipedia.org/wiki/Persistent_data_structure">Persistent Data structure</a>,
which doesn’t actually create a new object but reuses the existing one and still having the variables immutable.</p>
</div>
<div class="paragraph">
<p><strong>Q:</strong> It is nice that the programs are concise. But anyhow it has to execute so many lines behind
the scenes right? What is so nice about conciseness?</p>
</div>
<div class="paragraph">
<p>Programming with less code could probably mean more productivity. But surely means less testing, if you are
building on top of existing and pre-tested code. In that way, conciseness matters.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_edits">Edits:</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>17-Aug-2019 - Added description on <code>core.match</code>.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>This is expected to be an ongoing article. Will update here as get to see more amusing or hard things.</p>
</div>
</blockquote>
</div>
</div>
</div>

    </mainarticle>
</div>
<hr>

<div>
        <i>If you found the article helpful, please share or cite the article, and spread the word:</i>
            <p style="margin-top: 2%;">
                <span><a target="_blank" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;" title="Twitter" href="https://twitter.com/share?url=./clojure-amusing-and-hard-parts-for-a-java-developer.html&text=Clojure - Amusing and Hard parts for a Java developer&via="><img class="social-icons-a" src="./theme/images/icons/twitter.png"></a></span>
                <span><a target="_blank" title="Facebook" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;" href="https://www.facebook.com/sharer.php?u=./clojure-amusing-and-hard-parts-for-a-java-developer.html&t=Clojure - Amusing and Hard parts for a Java developer"><img class="social-icons-a" src="./theme/images/icons/facebook.png"></a></span>

                <a  target="_blank" title="Linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=./clojure-amusing-and-hard-parts-for-a-java-developer.html&title=Clojure - Amusing and Hard parts for a Java developer" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img class="social-icons-a" src="./theme/images/icons/linkedin.png"></a>
            </p>
</div>
<hr>
    <p><i>For any feedback or corrections, please write in to: </i><b> kannangce@rediffmail.com </b></p>

    <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "kannangce-in"; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
    </maincontent>

  <!-- Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-127824340-1']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </div>
</body>

</html>